[![Tests](../../actions/workflows/tests-13-sprint.yml/badge.svg)](../../actions/workflows/tests-13-sprint.yml) 
[![Tests](../../actions/workflows/tests-14-sprint.yml/badge.svg)](../../actions/workflows/tests-14-sprint.yml)


# Проект Mesto фронтенд + бэкенд

[Ссылка на GitHub репозиторий](https://github.com/chepash/express-mesto-gha)

Это проект является подготовительной частью будущего бэкенда, фронтенд для которого уже почти реализован. Пример работы фронтенда можно посмотреть на [GitHub Pages](https://chepash.github.io/react-mesto-auth/)


## Директории

- `/routes` — папка с файлами роутера  
- `/controllers` — папка с файлами контроллеров пользователя и карточки   
- `/models` — папка с файлами описания схем пользователя и карточки  
- `/errors` — папка с файлами кастомных классов ошибок
- `/utils` — папка с файлами используемых констант в проекте и дополнительных функций


## Запуск проекта

- `npm run start` — запускает сервер [localhost:3000](http://localhost:3000/)
- `npm run dev` — запускает сервер [localhost:3000](http://localhost:3000/) с `hot reload`;
- `npm run lint` — при запуске команды выполняется проверка проекта, в результате работы которой показываются ошибки линтинга
- `npm run lint-fix` — при запуске команды выполняется проверка проекта, в результате работы которой eslint попытается найти все ошибки и автоматически их исправить согласно своим настройкам


## Работа приложения:

- При успешном ответе сервера возвращается `json` ;
- При разных запросах сервер не падает и в консоли нет ошибок;
- При запуске приложение подключается к серверу mongo по адресу: `mongodb://127.0.0.1:27017/mestodb` ;
- В приложении описана схема пользователя с полями:
  - `name` — строка от 2 до 30 символов, обязательное поле;
  - `about` — строка от 2 до 30 символов, обязательное поле;
  - `avatar` — строка, обязательное поле.
- В приложении описана схема карточки с полями:
  - `name` — строка от 2 до 30 символов, обязательное поле;
  - `link` — строка, обязательное поле;
  - `owner` — `ObjectId`, обязательное поле;
  - `likes` — массив `ObjectId`, по умолчанию пустой;
  - `createdAt` — дата создания, по умолчанию `Date.now` .
- Все поля схем пользователя и карточки валидируются;
- В файлах схем создаются и экспортируются модели с именами `user` и `card` ;
- При обновлении пользователя или карточек в `options` передаётся `new: true` ;
- Каждый запрос обрабатывается `middleware`, которая добавляет к объекту запроса поле user , содержащее объект с захардкоженным `_id` ользователя;
- Ответ сервера на запрос отправляется только один раз.


## Приложение корректно обрабатывает запросы по следующим роутам:

- `GET /users/:userId` — возвращает пользователя по `_id` ;
- `GET /users` — возвращает всех пользователей из базы;
- `POST /users` — создаёт пользователя с переданными в теле запроса `name` , `about` и `avatar` ;
- `PATCH /users/me` — обновляет профиль пользователя;
- `PATCH /users/me/avatar` — обновляет аватар пользователя;
- `GET /cards` — возвращает все карточки из базы;
- `POST /cards` — создаёт карточку с переданными в теле запроса `name` и `link` , устанавливает поле `owner` для карточки;
- `DELETE /cards/:cardId` — удаляет карточку по `_id` ;
- `PUT /cards/:cardId/likes` — ставит лайк карточке;
- `DELETE /cards/:cardId/likes` — убирает лайк с карточки.


## Обработка ошибок в приложении:

- Если в любом из запросов что-то идёт не так, сервер возвращает ответ с ошибкой и соответствующим ей статусом:
  - `400` — переданы некорректные данные в методы создания карточки, пользователя, обновления аватара пользователя или профиля;
  - `404` — карточка или пользователь не найден или был запрошен несуществующий роут;
  - `500` — ошибка по умолчанию. Сопровождается сообщением: «На сервере произошла ошибка».
- Во всех контроллерах предусмотрена гарантированная отправка сообщения об ошибке;
- Статусы ошибок вынесены в константы;
- Ответ с ошибкой содержит только поле message . Сообщение об ошибке соответствует её типу;


## Дополнительные нюансы

- При написании кода проекта использовался `eslint` :
  - настройки `eslint` расширяют конфигурацию `airbnb-base` ;
  - `eslint` не настроен на совместную работу с плагином `Prettier`;

